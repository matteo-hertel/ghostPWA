<link rel="import" href="../../bower_components/polymer/polymer-element.html">

<dom-module id="blog-seo">
    <template>
        <style>

        </style>
        <slot></slot>
    </template>

    <script>
        /**
         * @customElement
         * @polymer
         */
        class BlogSeo extends Polymer.Element {
            static get is() {
                return 'blog-seo';
            }
            get dataElement() {
                return document.getElementById("structuredData");
            }
            ready() {
                super.ready();
                this.addEventListeners();
            }
            addEventListeners() {
                this.addEventListener("seo-update", (e) => {
                    e.stopPropagation();
                    if (e.detail.hasStructuredData) {
                        this.processStructuredData(e.detail);
                    } else {
                        this.nukeStructuredData();
                    }
                    this.processSeoData(e.detail);
                });
            }
            processStructuredData(data) {
                this.dataElement.innerHTML = `
                    {
                    "@context": "http://schema.org",
                    "@type": "NewsArticle",
                    "mainEntityOfPage": {
                        "@type": "WebPage",
                        "@id": "https://google.com/article"
                    },
                    "headline": "Article headline",
                    "image": {
                        "@type": "ImageObject",
                        "url": "https://google.com/thumbnail1.jpg",
                        "height": 800,
                        "width": 800
                    },
                    "datePublished": "2015-02-05T08:00:00+08:00",
                    "dateModified": "2015-02-05T09:20:00+08:00",
                    "author": {
                        "@type": "Person",
                        "name": "John Doe"
                    },
                    "publisher": {
                        "@type": "Organization",
                        "name": "Google",
                        "logo": {
                        "@type": "ImageObject",
                        "url": "https://google.com/logo.jpg",
                        "width": 600,
                        "height": 60
                        }
                    },
                    "description": "A most wonderful article"
                    }
                `;
            }
            nukeStructuredData(data) {
                this.dataElement.innerHTML = "";
            }
            processSeoData(data) {
                document.title = data.seoData.title;
            }
        }

        window.customElements.define(BlogSeo.is, BlogSeo);
    </script>
</dom-module>