<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/iron-meta/iron-meta.html">

<dom-module id="blog-config">
    <template>
        <iron-meta key="config" value="[[config]]"></iron-meta>
        <iron-meta key="lol" value="foo"></iron-meta>
    </template>

    <script>
        /**
         * `blog-config`
         * Ghost blog config component
         *
         * @customElement
         * @polymer
         * @demo demo/index.html
         */
        class Blogconfig extends Polymer.Element {
            static get is() {
                return 'blog-config';
            }
            static get properties() {
                let staticConfig = {
                    baseUrl: `http://localhost:8112/ghost/api/v0.1/`,
                    client_id: "ghost-frontend",
                    client_secret: "becb93feb204"
                }
                let dynamicConfig = {
                    getAPIUrl: (path, queryParams = []) => {
                        let additionalParams = queryParams.reduce((acc, obj) => {
                            Object.keys(obj).map((ey) => { acc += `&${ey}=${obj[ey]}` })
                            return acc;
                        }, "")
                        return `${staticConfig.baseUrl}${path}?client_id=${staticConfig.client_id}&client_secret=${staticConfig.client_secret}${additionalParams}`;
                    }
                }
                return {
                    config: {
                        type: Object,
                        value: Object.assign(staticConfig, dynamicConfig)
                    }
                }
            }
        }

        window.customElements.define(Blogconfig.is, Blogconfig);
    </script>
</dom-module>